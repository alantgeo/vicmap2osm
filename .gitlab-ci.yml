image: "debian:buster-slim"

stages:
  - build

build:
  stage: build
  script:
    - apt-get update && apt-get install -y curl gnupg gdal-bin unzip wget make
    - curl -fsSL https://deb.nodesource.com/setup_12.x | bash -
    - curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add -
    - echo "deb https://dl.yarnpkg.com/debian/ stable main" | tee /etc/apt/sources.list.d/yarn.list
    - apt-get update && apt-get install -y yarn nodejs
    - yarn install
    - mkdir -p dist
    - make data/VICMAP_ADDRESS.zip unzip
    - make data/vicmap.geojson
    - make dist/vicmap-osm.geojson
  artifacts:
    name: "build"
    paths:
      - dist
